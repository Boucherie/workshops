<!doctype html>
<html>
  <head>
    <style>
      * {
        box-sizing: border-box;
      }

      div {
        background: #ddd;
        padding: 20px;
        margin: 5px;
        border-radius: 4px;
      }
    </style>
    <link rel='stylesheet' href='./libby.css' />
  </head>
  <body>
    <button onclick='toggleStaggerOnClick(event)' data-target='#one'>Click</button>
    <div class='ax-stagger ax-stagger-fade ax-activeOn-scroll' id='one'>
      <p>Paragraph Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah</p>
      <p>Paragraph Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah</p>
      <p>Paragraph Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah</p>
      <p>Paragraph Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah</p>
      <p>Paragraph Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah</p>
      <p>Paragraph Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah</p>
      <p>Paragraph Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah</p>
      <p>Paragraph Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah</p>
      <p>Paragraph Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah</p>
    </div>

    <div class='ax-stagger ax-stagger-fade ax-activeOn-scroll'>
      <p>Paragraph Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah</p>
      <p>Paragraph Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah</p>
      <p>Paragraph Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah</p>
      <p>Paragraph Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah</p>
      <p>Paragraph Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah</p>
      <p>Paragraph Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah</p>
      <p>Paragraph Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah</p>
      <p>Paragraph Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah</p>
      <p>Paragraph Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah Paragrah</p>
    </div>

    <button onclick='toggleStaggerOnClick(event)' data-target='#two'>Click</button>
    <div class='ax-stagger ax ax-fade ax-color' id='two'>
      <div class='ax ax-fade ax-right'>Hello</div>
      <div class='ax ax-fade ax-right'>Hello</div>
      <div class='ax ax-fade ax-right'>Hello</div>
      <div class='ax ax-fade ax-right'>Hello</div>
    </div>


    <script>
      const toggleStaggerOnClick = (event) => {
        const targetSelector = event.target.getAttribute('data-target')
        const node = document.querySelector(targetSelector)
        toggleStagger(node)
      }


      const toggleStagger = (node) => {
        if (!node) return
        node.classList.toggle('active')
        Array.from(node.children).forEach((child, index) => {
          const multiplier = index >= 5 ? 5 : index
          child.style.transitionDelay = `${multiplier * 60}ms`
          child.classList.toggle('active', node.classList.contains('active'))
        })
      }


      const toggleActive = (event) => {
        const targetNode = event.target
        if (!targetNode.classList.contains('ax')) return
        targetNode.classList.toggle('active')
      }
      document.addEventListener('click', toggleActive)


      const activeOnVisible = (node) => {
        const bufferOffset = window.innerHeight / 2
        const visiblyScrolled = window.scrollY + window.innerHeight
        if (visiblyScrolled >= (node.offsetTop + bufferOffset)) {
          toggleStagger(node)
        }
      }


      const activeOnScroll = () => {
        const nodes = Array.from(document.querySelectorAll('.ax-activeOn-scroll'))

        const targetNodes = nodes.filter(n => !n.classList.contains('active'))
        if (!targetNodes.length) {
          window.removeEventListener('scroll', activeOnScroll)
        }

        targetNodes.forEach(activeOnVisible)
      }

      window.addEventListener('scroll', activeOnScroll)
      window.addEventListener('load', activeOnScroll)
    </script>
  </body>
</html>